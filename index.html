<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pediatric Nursing Flashcards - Chapter 4: Communication & Assessment</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', 'Arial', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #004085 0%, #0069d9 100%);
            min-height: 100vh;
            padding: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        
        .container {
            width: 100%;
            max-width: 1200px;
            height: 96vh;
            background: #f8f9fa;
            border-radius: 20px;
            box-shadow: 0 15px 40px rgba(0,0,0,0.25);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            border: 3px solid #17a2b8;
        }
        
        .header {
            background: linear-gradient(135deg, #0056b3, #0069d9);
            color: white;
            padding: 12px 15px;
            text-align: center;
            position: relative;
            overflow: hidden;
            flex-shrink: 0;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" width="100" height="100" opacity="0.1"><path d="M50,10 L60,25 L77,28 L67,40 L70,57 L50,48 L30,57 L33,40 L23,28 L40,25 Z" fill="white"/><circle cx="50" cy="30" r="8" fill="white"/><circle cx="40" cy="45" r="5" fill="white"/><circle cx="60" cy="45" r="5" fill="white"/></svg>');
            background-size: 80px 80px;
        }
        
        .header h1 {
            font-size: 1.5rem;
            margin-bottom: 4px;
            position: relative;
            color: #e3f2fd;
            line-height: 1.2;
        }
        
        .header .subtitle {
            font-size: 0.9rem;
            opacity: 0.9;
            position: relative;
            color: #bbdefb;
            margin-bottom: 8px;
        }
        
        .progress {
            background: #004085;
            height: 6px;
            width: 100%;
            flex-shrink: 0;
            border-radius: 0 0 5px 5px;
        }
        
        .progress-bar {
            background: linear-gradient(90deg, #17a2b8, #20c997);
            height: 100%;
            width: 0%;
            transition: width 0.4s ease;
            border-radius: 0 5px 5px 0;
        }
        
        .section-nav {
            display: flex;
            gap: 6px;
            padding: 8px 10px;
            background: linear-gradient(135deg, #0069d9, #0056b3);
            border-bottom: 1px solid #17a2b8;
            flex-shrink: 0;
            overflow-x: auto;
            align-items: center;
            justify-content: center;
        }
        
        .section-btn {
            padding: 5px 10px;
            border: 2px solid #17a2b8;
            background: rgba(255,255,255,0.95);
            color: #0056b3;
            border-radius: 15px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            font-size: 0.75rem;
            white-space: nowrap;
            flex-shrink: 0;
            min-width: 120px;
            text-align: center;
        }
        
        .section-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(23, 162, 184, 0.4);
        }
        
        .section-btn.active {
            background: linear-gradient(135deg, #17a2b8, #20c997);
            color: white;
            border-color: #0056b3;
            box-shadow: 0 6px 12px rgba(23, 162, 184, 0.5);
        }
        
        .flashcard {
            padding: 12px;
            flex: 1;
            display: flex;
            flex-direction: column;
            background: #f8f9fa;
            overflow: hidden;
            min-height: 0;
        }
        
        .question-container {
            display: flex;
            gap: 10px;
            align-items: flex-start;
            margin-bottom: 8px;
            background: white;
            padding: 12px;
            border-radius: 10px;
            border-left: 6px solid #17a2b8;
            box-shadow: 0 4px 8px rgba(0,0,0,0.08);
            flex-shrink: 0;
        }
        
        .question-icon {
            background: linear-gradient(135deg, #0056b3, #17a2b8);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            font-weight: bold;
            flex-shrink: 0;
            box-shadow: 0 4px 8px rgba(0, 86, 179, 0.4);
        }
        
        .question {
            font-size: 0.9rem;
            line-height: 1.4;
            color: #2c3e50;
            flex-grow: 1;
            font-weight: 500;
            overflow-wrap: break-word;
            hyphens: auto;
        }
        
        .multiple-select-indicator {
            background: #dc3545;
            color: white;
            padding: 3px 8px;
            border-radius: 15px;
            font-size: 0.7rem;
            font-weight: bold;
            margin-left: 6px;
            white-space: nowrap;
            box-shadow: 0 3px 6px rgba(220, 53, 69, 0.3);
            flex-shrink: 0;
        }
        
        .options {
            display: flex;
            flex-direction: column;
            gap: 6px;
            margin-bottom: 8px;
            flex: 1;
            overflow: hidden;
            min-height: 0;
        }
        
        .option {
            padding: 8px 10px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
            display: flex;
            align-items: flex-start;
            gap: 10px;
            font-size: 0.85rem;
            line-height: 1.3;
            flex-shrink: 0;
            min-height: 45px;
        }
        
        .option:hover {
            background: #e8f4f8;
            border-color: #6cbbdb;
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(108, 187, 219, 0.2);
        }
        
        .option-letter {
            background: #d1ecf1;
            color: #0056b3;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            flex-shrink: 0;
            transition: all 0.3s ease;
            font-size: 0.8rem;
            border: 2px solid #bee5eb;
        }
        
        /* CORRECT - ALWAYS GREEN */
        .option.correct {
            background: #d4edda;
            border-color: #28a745;
            color: #155724;
        }
        
        .option.correct .option-letter {
            background: #28a745;
            color: white;
            border-color: #28a745;
        }
        
        /* INCORRECT - ALWAYS RED */
        .option.incorrect {
            background: #f8d7da;
            border-color: #dc3545;
            color: #721c24;
        }
        
        .option.incorrect .option-letter {
            background: #dc3545;
            color: white;
            border-color: #dc3545;
        }
        
        .option.selected {
            background: #cce5ff;
            border-color: #17a2b8;
            color: #0056b3;
        }
        
        .option.selected .option-letter {
            background: #17a2b8;
            color: white;
            border-color: #0056b3;
        }
        
        .feedback {
            padding: 8px 10px;
            border-radius: 8px;
            margin-bottom: 8px;
            display: none;
            align-items: center;
            gap: 8px;
            font-weight: 600;
            font-size: 0.85rem;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            flex-shrink: 0;
        }
        
        .feedback.correct {
            background: #d4edda;
            border: 3px solid #28a745;
            color: #155724;
            display: flex;
        }
        
        .feedback.incorrect {
            background: #f8d7da;
            border: 3px solid #dc3545;
            color: #721c24;
            display: flex;
        }
        
        .feedback-icon {
            font-size: 1.2rem;
            flex-shrink: 0;
        }
        
        .navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 12px;
            background: #d1ecf1;
            border-top: 2px solid #bee5eb;
            flex-shrink: 0;
            gap: 8px;
        }
        
        .counter {
            font-weight: bold;
            color: #0056b3;
            font-size: 0.9rem;
            background: white;
            padding: 5px 10px;
            border-radius: 20px;
            border: 2px solid #17a2b8;
            box-shadow: 0 3px 6px rgba(0,0,0,0.1);
            flex-shrink: 0;
        }
        
        .btn {
            padding: 8px 12px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 0.8rem;
            white-space: nowrap;
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #0056b3, #17a2b8);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 16px rgba(0, 86, 179, 0.4);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #20c997, #0056b3);
            color: white;
        }
        
        .btn-secondary:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 16px rgba(32, 201, 151, 0.4);
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #ffc107, #e0a800);
            color: #212529;
        }
        
        .btn-warning:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 16px rgba(255, 193, 7, 0.4);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #dc3545, #c82333);
            color: white;
        }
        
        .btn-danger:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 16px rgba(220, 53, 69, 0.4);
        }
        
        .rationale {
            background: linear-gradient(135deg, #fff3cd, #ffeaa7);
            border: 3px solid #ffc107;
            border-radius: 10px;
            padding: 10px;
            margin-top: 8px;
            display: none;
            box-shadow: 0 4px 12px rgba(255, 193, 7, 0.2);
            flex-shrink: 0;
            overflow: hidden;
            max-height: 120px;
        }
        
        .rationale.show {
            display: block;
            animation: slideIn 0.5s ease;
        }
        
        .rationale h4 {
            color: #e0a800;
            margin-bottom: 6px;
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 0.9rem;
        }
        
        .rationale p {
            color: #856404;
            line-height: 1.4;
            font-size: 0.8rem;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .stats {
            display: flex;
            gap: 6px;
            justify-content: center;
            margin-top: 4px;
            flex-wrap: wrap;
            flex-shrink: 0;
        }
        
        .stat {
            background: rgba(255,255,255,0.2);
            padding: 4px 8px;
            border-radius: 15px;
            font-size: 0.7rem;
            white-space: nowrap;
            border: 1px solid rgba(255,255,255,0.3);
        }
        
        .cancel-selection {
            background: linear-gradient(135deg, #dc3545, #c82333);
            color: white;
            margin: 0 auto 8px auto;
            display: none;
            box-shadow: 0 4px 10px rgba(220, 53, 69, 0.3);
            flex-shrink: 0;
        }
        
        .cancel-selection:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 16px rgba(220, 53, 69, 0.4);
        }
        
        .cancel-selection.show {
            display: flex;
        }
        
        .multiple-select-instructions {
            text-align: center;
            color: #dc3545;
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 0.8rem;
            background: #fff3cd;
            padding: 6px;
            border-radius: 8px;
            border: 2px solid #ffeaa7;
            flex-shrink: 0;
        }
        
        .matching-container {
            background: linear-gradient(135deg, #f8f9fa, #e8f4f8);
            border-radius: 8px;
            padding: 10px;
            border: 2px solid #dee2e6;
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            min-height: 0;
        }
        
        .matching-question {
            font-size: 0.85rem;
            color: #2c3e50;
            font-weight: 500;
            margin-bottom: 10px;
            padding: 8px;
            background: white;
            border-radius: 8px;
            border: 2px solid #dee2e6;
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            max-height: 3em;
            flex-shrink: 0;
        }
        
        .matching-options {
            flex: 1;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 5px;
            overflow: hidden;
            padding: 2px;
            min-height: 0;
        }
        
        .matching-option {
            padding: 8px;
            border: 2px dashed #6cbbdb;
            border-radius: 6px;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s ease;
            font-size: 0.8rem;
            font-weight: 500;
            color: #17a2b8;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 40px;
            overflow: hidden;
            line-height: 1.2;
        }
        
        .matching-option:hover {
            background: #e8f4f8;
            border-style: solid;
            border-color: #17a2b8;
        }
        
        .matching-option.correct {
            background: linear-gradient(135deg, #d4edda, #c3e6cb);
            border-color: #28a745;
            border-style: solid;
            color: #155724;
        }
        
        .matching-option.incorrect {
            background: linear-gradient(135deg, #f8d7da, #f5c6cb);
            border-color: #dc3545;
            border-style: solid;
            color: #721c24;
        }
        
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1) !important;
        }
        
        /* Remove all scrollbars */
        .options,
        .matching-options,
        .rationale,
        .container,
        .flashcard,
        body {
            overflow: hidden !important;
            -ms-overflow-style: none !important;
            scrollbar-width: none !important;
        }
        
        .options::-webkit-scrollbar,
        .matching-options::-webkit-scrollbar,
        .rationale::-webkit-scrollbar {
            display: none !important;
            width: 0 !important;
            height: 0 !important;
        }
        
        @media (max-width: 768px) {
            .container {
                height: 98vh;
            }
            
            .section-btn {
                min-width: 100px;
                font-size: 0.7rem;
                padding: 4px 8px;
            }
            
            .matching-options {
                grid-template-columns: 1fr;
            }
            
            .header {
                padding: 10px 12px;
            }
            
            .header h1 {
                font-size: 1.2rem;
            }
            
            .navigation {
                padding: 8px 10px;
                flex-wrap: wrap;
                justify-content: center;
                gap: 6px;
            }
            
            .counter {
                order: -1;
                width: 100%;
                text-align: center;
                margin-bottom: 4px;
                font-size: 0.8rem;
            }
            
            .btn {
                padding: 6px 10px;
                font-size: 0.75rem;
            }
            
            .question {
                font-size: 0.85rem;
            }
            
            .option {
                font-size: 0.8rem;
                padding: 6px 8px;
                min-height: 40px;
            }
            
            .question-icon {
                width: 35px;
                height: 35px;
                font-size: 0.9rem;
            }
            
            .option-letter {
                width: 22px;
                height: 22px;
                font-size: 0.75rem;
            }
        }
        
        @media (max-height: 700px) {
            .container {
                height: 99vh;
            }
            
            .header {
                padding: 8px 10px;
            }
            
            .header h1 {
                font-size: 1.1rem;
            }
            
            .header .subtitle {
                font-size: 0.8rem;
            }
            
            .question-container {
                padding: 10px;
                margin-bottom: 6px;
            }
            
            .question {
                font-size: 0.8rem;
                line-height: 1.3;
            }
            
            .option {
                padding: 6px 8px;
                min-height: 35px;
                font-size: 0.75rem;
            }
            
            .navigation {
                padding: 6px 8px;
            }
            
            .rationale {
                max-height: 80px;
                padding: 8px;
            }
            
            .feedback {
                padding: 6px 8px;
                font-size: 0.75rem;
            }
            
            .option-letter {
                width: 20px;
                height: 20px;
                font-size: 0.7rem;
            }
            
            .stats {
                display: none;
            }
        }
        
        @media (max-height: 600px) {
            .question-container {
                padding: 8px;
            }
            
            .question-icon {
                width: 30px;
                height: 30px;
                font-size: 0.8rem;
            }
            
            .option {
                min-height: 30px;
                padding: 4px 6px;
                font-size: 0.7rem;
            }
            
            .option-letter {
                width: 18px;
                height: 18px;
                font-size: 0.65rem;
            }
            
            .btn {
                padding: 5px 8px;
                font-size: 0.7rem;
            }
            
            .rationale {
                max-height: 60px;
                padding: 6px;
            }
            
            .rationale p {
                font-size: 0.7rem;
                line-height: 1.3;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üè• Chapter 04: Communication, Physical, and Developmental Assessment</h1>
            <div class="subtitle">Child Health Promotion Flashcards - Healthcare Professional Theme</div>
            <div class="stats">
                <div class="stat">üìö 49 Questions</div>
                <div class="stat">üéØ Immediate Feedback</div>
                <div class="stat">‚úÖ Green/Red System</div>
                <div class="stat">üîÑ Multiple Question Types</div>
            </div>
        </div>
        <div class="progress">
            <div class="progress-bar" id="progressBar"></div>
        </div>
        
        <div class="section-nav">
            <button class="section-btn active" onclick="setSection('multiple-choice')">Multiple Choice (43)</button>
            <button class="section-btn" onclick="setSection('multiple-response')">Multiple Response (6)</button>
            <button class="section-btn" onclick="setSection('matching')">Matching (0)</button>
            <button class="section-btn" onclick="setSection('all')">All Mixed (49)</button>
        </div>
        
        <div class="flashcard">
            <div class="question-container">
                <div class="question-icon" id="questionNumber">1</div>
                <div class="question" id="question"></div>
                <div class="multiple-select-indicator" id="multipleSelectIndicator" style="display: none;">Multiple Answers</div>
            </div>
            
            <div class="multiple-select-instructions" id="multipleSelectInstructions" style="display: none;">
                üí° Select ALL correct answers
            </div>
            
            <div class="options" id="options"></div>
            
            <div class="matching-container" id="matchingContainer" style="display: none;">
                <div class="matching-question" id="matchingQuestion"></div>
                <div class="matching-options" id="matchingOptions"></div>
            </div>
            
            <button class="btn cancel-selection" id="cancelBtn" onclick="cancelSelection()">
                üîÑ Reset
            </button>
            
            <div class="feedback" id="feedback">
                <div class="feedback-icon" id="feedbackIcon"></div>
                <div id="feedbackText"></div>
            </div>
            <div class="rationale" id="rationale">
                <h4>üí° Rationale:</h4>
                <p id="rationaleText"></p>
            </div>
        </div>
        
        <div class="navigation">
            <button class="btn btn-secondary" id="prevBtn" onclick="previousCard()">
                ‚¨ÖÔ∏è Prev
            </button>
            <div class="counter" id="counter">1/43</div>
            <button class="btn btn-warning" id="submitBtn" onclick="submitAnswer()" style="display: none;">
                ‚úÖ Submit
            </button>
            <button class="btn btn-primary" id="nextBtn" onclick="nextCard()">
                Next ‚û°Ô∏è
            </button>
        </div>
    </div>

    <script>
        // Chapter 4 Data - Communication, Physical, and Developmental Assessment
        const sections = {
            'multiple-choice': [
                {
                    question: "The nurse is seeing an adolescent and the parents in the clinic for the first time. Which should the nurse do first?",
                    options: ["Introduce him- or herself.", "Make the family comfortable.", "Give assurance of privacy.", "Explain the purpose of the interview."],
                    correct: 0,
                    rationale: "The first thing that nurses must do is to introduce themselves to the patient and family. Parents and other adults should be addressed with appropriate titles unless they specify a preferred name."
                },
                {
                    question: "Which is considered a block to effective communication?",
                    options: ["Using silence", "Using clich√©s", "Directing the focus", "Defining the problem"],
                    correct: 1,
                    rationale: "Using stereotyped comments or clich√©s can block effective communication. After the nurse uses such trite phrases, parents often do not respond."
                },
                {
                    question: "Which is the single most important factor to consider when communicating with children?",
                    options: ["Presence of the child's parent", "Child's physical condition", "Child's developmental level", "Child's nonverbal behaviors"],
                    correct: 2,
                    rationale: "The nurse must be aware of the child's developmental stage to engage in effective communication. The use of both verbal and nonverbal communication should be appropriate to the developmental level."
                },
                {
                    question: "Because children younger than 5 years are egocentric, the nurse should do which when communicating with them?",
                    options: ["Focus communication on the child.", "Use easy analogies when possible.", "Explain experiences of others to the child.", "Assure the child that communication is private."],
                    correct: 0,
                    rationale: "Because children of this age are able to see things only in terms of themselves, the best approach is to focus communication directly on them."
                },
                {
                    question: "The nurse's approach when introducing hospital equipment to a preschooler who seems afraid should be based on which principle?",
                    options: ["The child may think the equipment is alive.", "Explaining the equipment will only increase the child's fear.", "One brief explanation will be enough to reduce the child's fear.", "The child is too young to understand what the equipment does."],
                    correct: 0,
                    rationale: "Young children attribute human characteristics to inanimate objects. They often fear that the objects may jump, bite, cut, or pinch all by themselves without human direction."
                },
                {
                    question: "When the nurse interviews an adolescent, which is especially important?",
                    options: ["Focus the discussion on the peer group.", "Allow an opportunity to express feelings.", "Use the same type of language as the adolescent.", "Emphasize that confidentiality will always be maintained."],
                    correct: 1,
                    rationale: "Adolescents, like all children, need opportunities to express their feelings. Often they interject feelings into their words. The nurse must be alert to the words and feelings expressed."
                },
                {
                    question: "The nurse is preparing to assess a 10-month-old infant. He is sitting on his father's lap and appears to be afraid of the nurse and of what might happen next. Which initial actions by the nurse should be most appropriate?",
                    options: ["Initiate a game of peek-a-boo.", "Ask the infant's father to place the infant on the examination table.", "Talk softly to the infant while taking him from his father.", "Undress the infant while he is still sitting on his father's lap."],
                    correct: 0,
                    rationale: "Peek-a-boo is an excellent means of initiating communication with infants while maintaining a safe, nonthreatening distance."
                },
                {
                    question: "An 8-year-old girl asks the nurse how the blood pressure apparatus works. The most appropriate nursing action is which?",
                    options: ["Ask her why she wants to know.", "Determine why she is so anxious.", "Explain in simple terms how it works.", "Tell her she will see how it works as it is used."],
                    correct: 2,
                    rationale: "School-age children require explanations and reasons for everything. They are interested in the functional aspect of all procedures, objects, and activities."
                },
                {
                    question: "The nurse is having difficulty communicating with a hospitalized 6-year-old child. Which technique should be most helpful?",
                    options: ["Recommend that the child keep a diary.", "Provide supplies for the child to draw a picture.", "Suggest that the parent read fairy tales to the child.", "Ask the parent if the child is always uncommunicative."],
                    correct: 1,
                    rationale: "Drawing is one of the most valuable forms of communication. Children's drawings tell a great deal about them because they are projections of the children's inner self."
                },
                {
                    question: "Which data should be included in a health history?",
                    options: ["Review of systems", "Physical assessment", "Growth measurements", "Record of vital signs"],
                    correct: 0,
                    rationale: "A review of systems is done to elicit information concerning any potential health problems. This further guides the interview process."
                },
                {
                    question: "The nurse is taking a health history of an adolescent. Which best describes how the chief complaint should be determined?",
                    options: ["Request a detailed listing of symptoms.", "Ask the adolescent, 'Why did you come here today?'", "Interview the parent away from the adolescent to determine the chief complaint.", "Use what the adolescent says to determine, in correct medical terminology, what the problem is."],
                    correct: 1,
                    rationale: "The chief complaint is the specific reason for the child's visit to the clinic, office, or hospital. Because the adolescent is the focus of the history, this is an appropriate way to determine the chief complaint."
                },
                {
                    question: "The nurse is interviewing the mother of an infant. The mother reports, 'I had a difficult delivery, and my baby was born prematurely.' This information should be recorded under which heading?",
                    options: ["History", "Present illness", "Chief complaint", "Review of systems"],
                    correct: 0,
                    rationale: "The history refers to information that relates to previous aspects of the child's health, not to the current problem. The difficult delivery and prematurity are important parts of the infant's history."
                },
                {
                    question: "Where in the health history does a record of immunizations belong?",
                    options: ["History", "Present illness", "Review of systems", "Physical assessment"],
                    correct: 0,
                    rationale: "The history contains information relating to all previous aspects of the child's health status. The immunizations are appropriately included in the history."
                },
                {
                    question: "The nurse is taking a sexual history on an adolescent girl. Which is the best way to determine whether she is sexually active?",
                    options: ["Ask her, 'Are you sexually active?'", "Ask her, 'Are you having sex with anyone?'", "Ask her, 'Are you having sex with a boyfriend?'", "Ask both the girl and her parent if she is sexually active."],
                    correct: 1,
                    rationale: "Asking the adolescent girl if she is having sex with anyone is a direct question that is well understood. The phrase 'sexually active' is broadly defined and may not provide specific information."
                },
                {
                    question: "When doing a nutritional assessment on a Hispanic family, the nurse learns that their diet consists mainly of vegetables, legumes, and starches. The nurse should recognize that this diet is which?",
                    options: ["Lacking in protein", "Indicating they live in poverty", "Providing sufficient amino acids", "Needing enrichment with meat and milk"],
                    correct: 2,
                    rationale: "A diet that contains vegetables, legumes, and starches may provide sufficient essential amino acids even though the actual amount of meat or dairy protein is low."
                },
                {
                    question: "Which parameter correlates best with measurements of total muscle mass?",
                    options: ["Height", "Weight", "Skinfold thickness", "Upper arm circumference"],
                    correct: 3,
                    rationale: "Upper arm circumference is correlated with measurements of total muscle mass. Muscle serves as the body's major protein reserve and is considered an index of the body's protein stores."
                },
                {
                    question: "The nurse is preparing to perform a physical assessment on a 10-year-old girl. The nurse gives her the option of her mother staying in the room or leaving. This action should be considered which?",
                    options: ["Appropriate because of child's age", "Appropriate, but the mother may be uncomfortable", "Inappropriate because of child's age", "Inappropriate because child is same sex as mother"],
                    correct: 0,
                    rationale: "It is appropriate to give older school-age children the option of having the parent present or not. During the examination, the nurse should respect the child's need for privacy."
                },
                {
                    question: "With the National Center for Health Statistics criteria, which body mass index (BMI)-for-age percentiles should indicate the patient is at risk for being overweight?",
                    options: ["10th percentile", "75th percentile", "85th percentile", "95th percentile"],
                    correct: 2,
                    rationale: "Children who have BMI-for-age greater than or equal to the 85th percentile and less than the 95th percentile are at risk for being overweight."
                },
                {
                    question: "Rectal temperatures are indicated in which situation?",
                    options: ["In the newborn period", "Whenever accuracy is essential", "Rectal temperatures are never indicated", "When rapid temperature changes are occurring"],
                    correct: 1,
                    rationale: "Rectal temperatures are recommended when definitive measurements are necessary in infants older than age 1 month."
                },
                {
                    question: "What is the earliest age at which a satisfactory radial pulse can be taken in children?",
                    options: ["1 year", "2 years", "3 years", "6 years"],
                    correct: 1,
                    rationale: "Satisfactory radial pulses can be taken in children older than 2 years. In infants and young children, the apical pulse is more reliable."
                },
                {
                    question: "The nurse needs to take the blood pressure of a small child. Of the cuffs available, one is too large and one is too small. The best nursing action is which?",
                    options: ["Use the small cuff.", "Use the large cuff.", "Use either cuff using the palpation method.", "Wait to take the blood pressure until a proper cuff can be located."],
                    correct: 1,
                    rationale: "If blood pressure measurement is indicated and the appropriate size cuff is not available, the next larger size is used."
                },
                {
                    question: "Where is the best place to observe for the presence of petechiae in dark-skinned individuals?",
                    options: ["Face", "Buttocks", "Oral mucosa", "Palms and soles"],
                    correct: 2,
                    rationale: "Petechiae, small distinct pinpoint hemorrhages, are difficult to see in dark-skinned individuals unless they are in the mouth or conjunctiva."
                },
                {
                    question: "During a routine health assessment, the nurse notes that an 8-month-old infant has a significant head lag. Which is the most appropriate action?",
                    options: ["Recheck head control at next visit.", "Teach the parents appropriate exercises.", "Schedule the child for further evaluation.", "Refer the child for further evaluation if the anterior fontanel is still open."],
                    correct: 2,
                    rationale: "Significant head lag after age 6 months strongly indicates cerebral injury and is referred for further evaluation."
                },
                {
                    question: "The nurse has just started assessing a young child who is febrile and appears ill. There is hyperextension of the child's head (opisthotonos) with pain on flexion. Which is the most appropriate action?",
                    options: ["Ask the parent when the neck was injured.", "Refer for immediate medical evaluation.", "Continue assessment to determine the cause of the neck pain.", "Record 'head lag' on the assessment record and continue the assessment of the child."],
                    correct: 1,
                    rationale: "Hyperextension of the child's head with pain on flexion is indicative of meningeal irritation and needs immediate evaluation."
                },
                {
                    question: "During a funduscopic examination of a school-age child, the nurse notes a brilliant, uniform red reflex in both eyes. The nurse should recognize that this is which?",
                    options: ["A normal finding", "A sign of a possible visual defect and a need for vision screening", "An abnormal finding requiring referral to an ophthalmologist", "A sign of small hemorrhages, which usually resolve spontaneously"],
                    correct: 0,
                    rationale: "A brilliant, uniform red reflex is an important normal finding. It rules out many serious defects of the cornea, aqueous chamber, lens, and vitreous chamber."
                },
                {
                    question: "Which explains the importance of detecting strabismus in young children?",
                    options: ["Color vision deficit may result.", "Amblyopia, a type of blindness, may result.", "Epicanthal folds may develop in the affected eye.", "Corneal light reflexes may fall symmetrically within each pupil."],
                    correct: 1,
                    rationale: "If strabismus is not detected and corrected by age 4 to 6 years, blindness from disuse, known as amblyopia, may occur."
                },
                {
                    question: "Which is the most frequently used test for measuring visual acuity?",
                    options: ["Snellen letter chart", "Ishihara vision test", "Allen picture card test", "Denver eye screening test"],
                    correct: 0,
                    rationale: "The Snellen letter chart, which consists of lines of letters of decreasing size, is the most frequently used test for visual acuity."
                },
                {
                    question: "The nurse is testing an infant's visual acuity. By which age should the infant be able to fix on and follow a target?",
                    options: ["1 month", "1 to 2 months", "3 to 4 months", "6 months"],
                    correct: 2,
                    rationale: "Visual fixation and ability to follow a target should be present by ages 3 to 4 months."
                },
                {
                    question: "During an otoscopic examination on an infant, in which direction is the pinna pulled?",
                    options: ["Up and back", "Up and forward", "Down and back", "Down and forward"],
                    correct: 2,
                    rationale: "In infants and toddlers, the ear canal is curved upward. To visualize the ear canal, it is necessary to pull the pinna down and back."
                },
                {
                    question: "What is an appropriate screening test for hearing that the nurse can administer to a 5-year-old child?",
                    options: ["Rinne test", "Weber test", "Pure tone audiometry", "Eliciting the startle reflex"],
                    correct: 2,
                    rationale: "Pure tone audiometry uses an audiometer that produces sounds at different volumes and pitches in the child's ears."
                },
                {
                    question: "What is the appropriate placement of a tongue blade for assessment of the mouth and throat?",
                    options: ["On the lower jaw", "Side of the tongue", "Against the soft palate", "Center back area of the tongue"],
                    correct: 1,
                    rationale: "The side of the tongue is the correct position. It avoids the gag reflex yet allows visualization."
                },
                {
                    question: "When assessing a preschooler's chest, what should the nurse expect?",
                    options: ["Respiratory movements to be chiefly thoracic", "Anteroposterior diameter to be equal to the transverse diameter", "Retraction of the muscles between the ribs on respiratory movement", "Movement of the chest wall to be symmetric bilaterally and coordinated with breathing"],
                    correct: 3,
                    rationale: "Movement of the chest wall should be symmetric bilaterally and coordinated with breathing."
                },
                {
                    question: "When auscultating an infant's lungs, the nurse detects diminished breath sounds. What should the nurse interpret this as?",
                    options: ["Suggestive of chronic pulmonary disease", "Suggestive of impending respiratory failure", "An abnormal finding warranting investigation", "A normal finding in infants younger than 1 year of age"],
                    correct: 2,
                    rationale: "Absent or diminished breath sounds are always an abnormal finding."
                },
                {
                    question: "Which type of breath sound is normally heard over the entire surface of the lungs except for the upper intrascapular area and the area beneath the manubrium?",
                    options: ["Vesicular", "Bronchial", "Adventitious", "Bronchovesicular"],
                    correct: 0,
                    rationale: "Vesicular breath sounds are heard over the entire surface of the lungs, with the exception of the upper intrascapular area and the area beneath the manubrium."
                },
                {
                    question: "The nurse is assessing a child's capillary refill time. This can be accomplished by doing what?",
                    options: ["Inspect the chest.", "Auscultate the heart.", "Palpate the apical pulse.", "Palpate the nail bed with pressure to produce a slight blanching."],
                    correct: 3,
                    rationale: "Capillary refill time is assessed by pressing lightly on the skin to produce blanching and then noting the amount of time it takes for the blanched area to refill."
                },
                {
                    question: "Which heart sound is produced by vibrations within the heart chambers or in the major arteries from the back-and-forth flow of blood?",
                    options: ["S1 and S2", "S3 and S4", "Murmur", "Physiologic splitting"],
                    correct: 2,
                    rationale: "Murmurs are the sounds that are produced in the heart chambers or major arteries from the back-and-forth flow of blood."
                },
                {
                    question: "Examination of the abdomen is performed correctly by the nurse in which order?",
                    options: ["Inspection, palpation, percussion, and auscultation", "Inspection, percussion, auscultation, and palpation", "Palpation, percussion, auscultation, and inspection", "Inspection, auscultation, percussion, and palpation"],
                    correct: 3,
                    rationale: "The correct order of abdominal examination is inspection, auscultation, percussion, and palpation."
                },
                {
                    question: "Superficial palpation of the abdomen is often perceived by the child as tickling. Which measure by the nurse is most likely to minimize this sensation and promote relaxation?",
                    options: ["Palpate another area simultaneously.", "Ask the child not to laugh or move if it tickles.", "Begin with deeper palpation and gradually progress to superficial palpation.", "Have the child help with palpation by placing his or her hand over the palpating hand."],
                    correct: 3,
                    rationale: "Having the child help with palpation by placing his or her hand over the palpating hand will help minimize the feeling of tickling and enlist the child's cooperation."
                },
                {
                    question: "During examination of a toddler's extremities, the nurse notes that the child is bowlegged. The nurse should recognize that this finding is which?",
                    options: ["Abnormal and requires further investigation", "Abnormal unless it occurs in conjunction with knock-knee", "Normal if the condition is unilateral or asymmetric", "Normal because the lower back and leg muscles are not yet well developed"],
                    correct: 3,
                    rationale: "Lateral bowing of the tibia (bowlegged) is an expected finding in toddlers when they begin to walk."
                },
                {
                    question: "The nurse is caring for a non-English-speaking child and family. Which should the nurse consider when using an interpreter?",
                    options: ["Pose several questions at a time.", "Use medical jargon when possible.", "Communicate directly with family members when asking questions.", "Carry on some communication in English with the interpreter about the family's needs."],
                    correct: 2,
                    rationale: "When using an interpreter, the nurse should communicate directly with family members when asking questions to reinforce interest in them and to observe nonverbal expressions."
                },
                {
                    question: "Which action should the nurse implement when taking an axillary temperature?",
                    options: ["Take the temperature through one layer of clothing.", "Add a degree to the result when recording the temperature.", "Place the tip of the thermometer under the arm in the center of the axilla.", "Hold the child's arm away from the body while taking the temperature."],
                    correct: 2,
                    rationale: "The thermometer tip should be placed under the arm in the center of the axilla and kept close to the skin, not clothing."
                },
                {
                    question: "The nurse is aware that skin turgor best estimates what?",
                    options: ["Perfusion", "Adequate hydration", "Amount of body fat", "Amount of anemia"],
                    correct: 1,
                    rationale: "Skin turgor is one of the best estimates of adequate hydration and nutrition."
                },
                {
                    question: "The Asian parent of a child being seen in the clinic avoids eye contact with the nurse. What is the best explanation for this considering cultural differences?",
                    options: ["The parent feels inferior to the nurse.", "The parent is showing respect for the nurse.", "The parent is embarrassed to seek health care.", "The parent feels responsible for her child's illness."],
                    correct: 1,
                    rationale: "In some ethnic groups, eye contact is avoided. In the Vietnamese culture, an individual may not look directly into the nurse's eyes as a sign of respect."
                }
            ],
            
            'multiple-response': [
                {
                    question: "The nurse is performing an otoscopic examination on a child. Which are normal findings the nurse should expect? (Select all that apply.)",
                    options: ["Ashen gray areas", "A well-defined light reflex", "A small, round, concave spot near the center of the drum", "The tympanic membrane is a nontransparent grayish color", "A whitish line extending from the umbo upward to the margin of the membrane"],
                    correct: [1, 2, 4],
                    rationale: "Normal findings include the light reflex and bony landmarks. The light reflex is a fairly well-defined, cone-shaped reflection. The bony landmarks include the umbo and the manubrium of the malleus."
                },
                {
                    question: "The nurse is assessing breath sounds on a child. Which are expected auscultated breath sounds? (Select all that apply.)",
                    options: ["Wheezes", "Crackles", "Vesicular", "Bronchial", "Bronchovesicular"],
                    correct: [2, 3, 4],
                    rationale: "Normal breath sounds are classified as vesicular, bronchovesicular, or bronchial. Wheezes or crackles are abnormal or adventitious sounds."
                },
                {
                    question: "The nurse is performing an oral examination on a preschool child. Which strategies should the nurse use to encourage the child to open the mouth for the examination? (Select all that apply.)",
                    options: ["Lightly brush the palate with a cotton swab.", "Perform the examination in front of a mirror.", "Let the child examine someone else's mouth first.", "Have the child breathe deeply and hold his or her breath.", "Use a tongue blade to help the child open his or her mouth."],
                    correct: [0, 1, 2, 3],
                    rationale: "To encourage a child to open the mouth for examination, the nurse can lightly brush the palate with a cotton swab, perform the examination in front of a mirror, let the child examine someone else's mouth first, and have the child breathe deeply and hold his or her breath."
                },
                {
                    question: "Which are effective auscultation techniques? (Select all that apply.)",
                    options: ["Ask the child to breathe shallowly.", "Apply light pressure on the chest piece.", "Use a symmetric and orderly approach.", "Place the stethoscope over one layer of clothing.", "Warm the stethoscope before placing it on the skin."],
                    correct: [2, 4],
                    rationale: "Effective auscultation techniques include using a symmetric approach and warming the stethoscope before placing it on the skin. Breath sounds are best heard if the child inspires deeply."
                },
                {
                    question: "The nurse is assessing heart sounds on a school-age child. Which should the nurse document as abnormal findings if found on the assessment? (Select all that apply.)",
                    options: ["S4 heart sound", "S3 heart sound", "Grade II murmur", "S1 louder at the apex of the heart", "S2 louder than S1 in the aortic area"],
                    correct: [0, 2, 4],
                    rationale: "S4 is rarely heard as a normal heart sound; it usually indicates the need for further cardiac evaluation. A grade II murmur is not normal. S2 is normally louder than S1 at the base of the heart, not specifically in the aortic area alone."
                },
                {
                    question: "The nurse understands that blocks to therapeutic communication include what? (Select all that apply.)",
                    options: ["Socializing", "Use of silence", "Using clich√©s", "Defending a situation", "Using open-ended questions"],
                    correct: [0, 2, 3],
                    rationale: "Blocks to communication include socializing, using clich√©s, and defending a situation. Use of silence and using open-ended questions are therapeutic communication techniques."
                }
            ],
            
            'matching': []
        };

        let currentSection = 'multiple-choice';
        let currentQuestion = 0;
        let selectedOption = null;
        let selectedOptions = [];
        let isSubmitted = false;
        let answers = {
            'multiple-choice': Array(sections['multiple-choice'].length).fill(null),
            'multiple-response': Array(sections['multiple-response'].length).fill({selected: [], submitted: false}),
            'matching': Array(sections['matching'].length).fill(null),
            'all': Array(
                sections['multiple-choice'].length + 
                sections['multiple-response'].length + 
                sections['matching'].length
            ).fill(null)
        };

        function setSection(section) {
            currentSection = section;
            currentQuestion = 0;
            selectedOption = null;
            selectedOptions = [];
            isSubmitted = false;
            
            document.querySelectorAll('.section-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            loadQuestion();
        }

        function isMultipleResponseQuestion() {
            if (currentSection === 'all') {
                const questionData = getCurrentQuestionData();
                return Array.isArray(questionData?.correct);
            }
            return currentSection === 'multiple-response';
        }

        function isMatchingSection() {
            if (currentSection === 'all') {
                const questionData = getCurrentQuestionData();
                return questionData?.isMatching || false;
            }
            return currentSection === 'matching';
        }

        function getCurrentQuestionData() {
            if (currentSection === 'all') {
                if (currentQuestion < sections['multiple-choice'].length) {
                    return {
                        ...sections['multiple-choice'][currentQuestion],
                        section: 'multiple-choice',
                        originalIndex: currentQuestion
                    };
                } else if (currentQuestion < sections['multiple-choice'].length + sections['multiple-response'].length) {
                    const idx = currentQuestion - sections['multiple-choice'].length;
                    return {
                        ...sections['multiple-response'][idx],
                        section: 'multiple-response',
                        originalIndex: idx
                    };
                } else {
                    const idx = currentQuestion - sections['multiple-choice'].length - sections['multiple-response'].length;
                    return sections['matching'][idx] || null;
                }
            } else if (currentSection === 'matching') {
                return sections['matching'][currentQuestion] || null;
            } else {
                return sections[currentSection][currentQuestion];
            }
        }

        function loadQuestion() {
            const questionData = getCurrentQuestionData();
            
            if (!questionData) return;
            
            const isMatching = questionData.isMatching || false;
            const isMultipleResponse = isMultipleResponseQuestion();
            
            // Update UI elements visibility
            document.getElementById('matchingContainer').style.display = isMatching ? 'flex' : 'none';
            document.getElementById('options').style.display = isMatching ? 'none' : 'flex';
            document.getElementById('multipleSelectIndicator').style.display = isMultipleResponse ? 'block' : 'none';
            document.getElementById('multipleSelectInstructions').style.display = isMultipleResponse ? 'block' : 'none';
            document.getElementById('cancelBtn').classList.remove('show');
            document.getElementById('submitBtn').style.display = isMultipleResponse ? 'flex' : 'none';
            document.getElementById('questionNumber').textContent = currentQuestion + 1;
            
            let totalQuestions;
            if (currentSection === 'all') {
                totalQuestions = sections['multiple-choice'].length + 
                               sections['multiple-response'].length + 
                               sections['matching'].length;
            } else if (currentSection === 'matching') {
                totalQuestions = sections['matching'].length;
            } else {
                totalQuestions = sections[currentSection].length;
            }
            
            const progress = ((currentQuestion + 1) / totalQuestions) * 100;
            document.getElementById('progressBar').style.width = `${progress}%`;
            document.getElementById('counter').textContent = `${currentQuestion + 1}/${totalQuestions}`;
            
            if (isMatching) {
                document.getElementById('matchingQuestion').textContent = questionData.question;
                loadMatchingOptions(questionData);
            } else {
                document.getElementById('question').textContent = questionData.question;
                loadOptions(questionData);
            }
            
            document.getElementById('feedback').style.display = 'none';
            document.getElementById('rationale').classList.remove('show');
            
            document.getElementById('prevBtn').disabled = currentQuestion === 0;
            const isLastQuestion = currentQuestion >= totalQuestions - 1;
            document.getElementById('nextBtn').textContent = isLastQuestion ? 'Finish ‚û°Ô∏è' : 'Next ‚û°Ô∏è';
            document.getElementById('nextBtn').disabled = true;
            
            // Load saved answer state
            const storedAnswer = answers[currentSection][currentQuestion];
            if (storedAnswer !== null && storedAnswer !== undefined) {
                if (isMultipleResponse) {
                    selectedOptions = storedAnswer.selected || [];
                    isSubmitted = storedAnswer.submitted || false;
                    
                    if (isSubmitted) {
                        showFeedbackForMultipleResponse(questionData);
                        document.getElementById('nextBtn').disabled = false;
                        document.getElementById('submitBtn').disabled = true;
                    } else {
                        highlightSelectedOptionsForMultipleResponse();
                        document.getElementById('submitBtn').disabled = selectedOptions.length === 0;
                        document.getElementById('nextBtn').disabled = false;
                        if (selectedOptions.length > 0) {
                            document.getElementById('cancelBtn').classList.add('show');
                        }
                    }
                } else if (isMatching) {
                    selectedOption = storedAnswer;
                    highlightMatchingOption(storedAnswer, questionData);
                    showFeedback(storedAnswer, questionData);
                    document.getElementById('nextBtn').disabled = false;
                    document.getElementById('cancelBtn').classList.add('show');
                } else {
                    selectedOption = storedAnswer;
                    highlightSelectedOption(storedAnswer, questionData);
                    showFeedback(storedAnswer, questionData);
                    document.getElementById('nextBtn').disabled = false;
                    document.getElementById('cancelBtn').classList.add('show');
                }
            } else {
                selectedOption = null;
                selectedOptions = [];
                isSubmitted = false;
                if (isMultipleResponse) {
                    document.getElementById('submitBtn').disabled = true;
                }
            }
        }

        function loadMatchingOptions(questionData) {
            const matchingOptions = document.getElementById('matchingOptions');
            matchingOptions.innerHTML = '';
            
            if (questionData.options) {
                questionData.options.forEach((option, index) => {
                    const optionDiv = document.createElement('div');
                    optionDiv.className = 'matching-option';
                    optionDiv.textContent = `${String.fromCharCode(65 + index)}) ${option}`;
                    optionDiv.onclick = () => selectMatchingOption(index, questionData);
                    matchingOptions.appendChild(optionDiv);
                });
                
                const storedAnswer = answers[currentSection][currentQuestion];
                if (storedAnswer !== null && storedAnswer !== undefined) {
                    highlightMatchingOption(storedAnswer, questionData);
                }
            }
        }

        function loadOptions(questionData) {
            const optionsContainer = document.getElementById('options');
            optionsContainer.innerHTML = '';
            
            questionData.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                optionElement.innerHTML = `
                    <div class="option-letter">${String.fromCharCode(65 + index)}</div>
                    <div class="option-text">${option}</div>
                `;
                optionElement.onclick = () => selectOption(index, questionData);
                optionsContainer.appendChild(optionElement);
            });
        }

        function selectOption(index, questionData) {
            if (!questionData) questionData = getCurrentQuestionData();
            
            if (isMultipleResponseQuestion()) {
                handleMultipleResponseSelect(index, questionData);
            } else {
                handleSingleSelect(index, questionData);
            }
        }

        function handleSingleSelect(index, questionData) {
            if (!questionData) questionData = getCurrentQuestionData();
            
            answers[currentSection][currentQuestion] = index;
            selectedOption = index;
            
            highlightSelectedOption(index, questionData);
            showFeedback(index, questionData);
            document.getElementById('nextBtn').disabled = false;
            document.getElementById('cancelBtn').classList.add('show');
        }

        function handleMultipleResponseSelect(index, questionData) {
            if (!questionData) questionData = getCurrentQuestionData();
            if (isSubmitted) return;
            
            const optionIndex = selectedOptions.indexOf(index);
            if (optionIndex === -1) {
                selectedOptions.push(index);
            } else {
                selectedOptions.splice(optionIndex, 1);
            }
            
            const options = document.querySelectorAll('.option');
            options.forEach((option, i) => {
                option.classList.remove('selected', 'correct', 'incorrect');
                if (selectedOptions.includes(i)) {
                    option.classList.add('selected');
                }
            });
            
            // Save the selection
            if (!answers[currentSection][currentQuestion]) {
                answers[currentSection][currentQuestion] = {selected: [], submitted: false};
            }
            answers[currentSection][currentQuestion].selected = selectedOptions;
            answers[currentSection][currentQuestion].submitted = false;
            
            document.getElementById('submitBtn').disabled = selectedOptions.length === 0;
            document.getElementById('nextBtn').disabled = false;
            document.getElementById('cancelBtn').classList.toggle('show', selectedOptions.length > 0);
        }

        function selectMatchingOption(index, questionData) {
            if (!questionData) questionData = getCurrentQuestionData();
            
            answers[currentSection][currentQuestion] = index;
            selectedOption = index;
            
            // Clear all classes first
            document.querySelectorAll('.matching-option').forEach(option => {
                option.classList.remove('selected', 'correct', 'incorrect');
            });
            
            const selectedOptionElement = document.querySelectorAll('.matching-option')[index];
            selectedOptionElement.classList.add('selected');
            
            if (index === questionData.correct) {
                selectedOptionElement.classList.add('correct');
            } else {
                selectedOptionElement.classList.add('incorrect');
                // Also show the correct answer
                document.querySelectorAll('.matching-option')[questionData.correct].classList.add('correct');
            }
            
            showFeedback(index, questionData);
            document.getElementById('nextBtn').disabled = false;
            document.getElementById('cancelBtn').classList.add('show');
        }

        function highlightMatchingOption(index, questionData) {
            if (!questionData) questionData = getCurrentQuestionData();
            
            const options = document.querySelectorAll('.matching-option');
            
            options.forEach((option, i) => {
                option.classList.remove('selected', 'correct', 'incorrect');
                if (i === index) {
                    option.classList.add('selected');
                    if (i === questionData.correct) {
                        option.classList.add('correct');
                    } else {
                        option.classList.add('incorrect');
                        options[questionData.correct].classList.add('correct');
                    }
                }
            });
        }

        function highlightSelectedOption(index, questionData) {
            if (!questionData) questionData = getCurrentQuestionData();
            
            const options = document.querySelectorAll('.option');
            
            options.forEach((option, i) => {
                option.classList.remove('selected', 'correct', 'incorrect');
                
                if (i === index) {
                    if (i === questionData.correct) {
                        option.classList.add('correct');
                    } else {
                        option.classList.add('incorrect');
                        options[questionData.correct].classList.add('correct');
                    }
                }
            });
        }

        function highlightSelectedOptionsForMultipleResponse() {
            const options = document.querySelectorAll('.option');
            
            options.forEach((option, i) => {
                option.classList.remove('selected', 'correct', 'incorrect');
                if (selectedOptions.includes(i)) {
                    option.classList.add('selected');
                }
            });
        }

        function submitAnswer() {
            if (selectedOptions.length === 0) return;
            
            isSubmitted = true;
            
            if (!answers[currentSection][currentQuestion]) {
                answers[currentSection][currentQuestion] = {selected: [], submitted: false};
            }
            answers[currentSection][currentQuestion].submitted = true;
            
            const questionData = getCurrentQuestionData();
            showFeedbackForMultipleResponse(questionData);
            document.getElementById('nextBtn').disabled = false;
            document.getElementById('submitBtn').disabled = true;
            document.getElementById('cancelBtn').classList.remove('show');
        }

        function showFeedback(index, questionData) {
            if (!questionData) questionData = getCurrentQuestionData();
            
            const feedback = document.getElementById('feedback');
            const feedbackIcon = document.getElementById('feedbackIcon');
            const feedbackText = document.getElementById('feedbackText');
            const rationale = document.getElementById('rationale');
            const rationaleText = document.getElementById('rationaleText');
            
            if (index === questionData.correct) {
                feedback.className = 'feedback correct';
                feedbackIcon.textContent = '‚úÖ';
                feedbackText.textContent = 'Correct! Well done.';
            } else {
                feedback.className = 'feedback incorrect';
                feedbackIcon.textContent = '‚ùå';
                const correctLetter = String.fromCharCode(65 + questionData.correct);
                feedbackText.textContent = `Incorrect. Correct: ${correctLetter}`;
            }
            
            feedback.style.display = 'flex';
            rationaleText.textContent = questionData.rationale;
            rationale.classList.add('show');
        }

        function showFeedbackForMultipleResponse(questionData) {
            if (!questionData) questionData = getCurrentQuestionData();
            
            const feedback = document.getElementById('feedback');
            const feedbackIcon = document.getElementById('feedbackIcon');
            const feedbackText = document.getElementById('feedbackText');
            const rationale = document.getElementById('rationale');
            const rationaleText = document.getElementById('rationaleText');
            
            const allCorrectSelected = questionData.correct.every(c => selectedOptions.includes(c));
            const noIncorrectSelected = selectedOptions.every(s => questionData.correct.includes(s));
            
            const options = document.querySelectorAll('.option');
            options.forEach((option, i) => {
                option.classList.remove('selected', 'correct', 'incorrect');
                if (questionData.correct.includes(i)) {
                    option.classList.add('correct');
                }
                if (selectedOptions.includes(i) && !questionData.correct.includes(i)) {
                    option.classList.add('incorrect');
                }
            });
            
            if (allCorrectSelected && noIncorrectSelected) {
                feedback.className = 'feedback correct';
                feedbackIcon.textContent = '‚úÖ';
                feedbackText.textContent = 'Perfect! All correct selected.';
            } else if (allCorrectSelected && !noIncorrectSelected) {
                feedback.className = 'feedback incorrect';
                feedbackIcon.textContent = '‚ö†Ô∏è';
                feedbackText.textContent = 'Almost! All correct + some incorrect.';
            } else if (!allCorrectSelected && noIncorrectSelected) {
                feedback.className = 'feedback incorrect';
                feedbackIcon.textContent = '‚ö†Ô∏è';
                feedbackText.textContent = 'Partially correct! Some correct, missed others.';
            } else {
                feedback.className = 'feedback incorrect';
                feedbackIcon.textContent = '‚ùå';
                feedbackText.textContent = 'Incorrect. Missed correct & selected incorrect.';
            }
            
            feedback.style.display = 'flex';
            rationaleText.textContent = questionData.rationale;
            rationale.classList.add('show');
        }

        function cancelSelection() {
            const questionData = getCurrentQuestionData();
            
            if (isMultipleResponseQuestion()) {
                selectedOptions = [];
                isSubmitted = false;
                
                const options = document.querySelectorAll('.option');
                options.forEach(option => {
                    option.classList.remove('selected', 'correct', 'incorrect');
                });
                
                if (answers[currentSection][currentQuestion]) {
                    answers[currentSection][currentQuestion] = {selected: [], submitted: false};
                }
                
                document.getElementById('nextBtn').disabled = true;
                document.getElementById('submitBtn').disabled = true;
                document.getElementById('feedback').style.display = 'none';
                document.getElementById('rationale').classList.remove('show');
                document.getElementById('cancelBtn').classList.remove('show');
            } else if (isMatchingSection()) {
                answers[currentSection][currentQuestion] = null;
                selectedOption = null;
                
                document.querySelectorAll('.matching-option').forEach(option => {
                    option.classList.remove('selected', 'correct', 'incorrect');
                });
                
                document.getElementById('feedback').style.display = 'none';
                document.getElementById('rationale').classList.remove('show');
                document.getElementById('nextBtn').disabled = true;
                document.getElementById('cancelBtn').classList.remove('show');
            } else {
                answers[currentSection][currentQuestion] = null;
                selectedOption = null;
                
                const options = document.querySelectorAll('.option');
                options.forEach(option => {
                    option.classList.remove('selected', 'correct', 'incorrect');
                });
                
                document.getElementById('feedback').style.display = 'none';
                document.getElementById('rationale').classList.remove('show');
                document.getElementById('nextBtn').disabled = true;
                document.getElementById('cancelBtn').classList.remove('show');
            }
        }

        function nextCard() {
            const totalQuestions = getTotalQuestions();
            
            if (currentQuestion < totalQuestions - 1) {
                currentQuestion++;
                selectedOption = null;
                selectedOptions = [];
                isSubmitted = false;
                loadQuestion();
            } else {
                let correctCount = 0;
                let totalAnswered = 0;
                
                Object.keys(answers).forEach(section => {
                    answers[section].forEach((answer, index) => {
                        if (answer !== null) {
                            totalAnswered++;
                            const questionData = getQuestionData(section, index);
                            
                            if (Array.isArray(questionData?.correct)) {
                                if (answer.submitted && Array.isArray(answer.selected)) {
                                    const allCorrect = questionData.correct.every(c => answer.selected.includes(c));
                                    const noIncorrect = answer.selected.every(s => questionData.correct.includes(s));
                                    if (allCorrect && noIncorrect) correctCount++;
                                }
                            } else if (questionData?.isMatching) {
                                if (answer === questionData.correct) correctCount++;
                            } else {
                                if (answer === questionData?.correct) correctCount++;
                            }
                        }
                    });
                });
                
                alert(`Quiz completed!\n\nAnswered: ${totalAnswered}\nCorrect: ${correctCount}\n\nClick OK to restart.`);
                
                currentSection = 'multiple-choice';
                currentQuestion = 0;
                selectedOption = null;
                selectedOptions = [];
                isSubmitted = false;
                answers = {
                    'multiple-choice': Array(sections['multiple-choice'].length).fill(null),
                    'multiple-response': Array(sections['multiple-response'].length).fill({selected: [], submitted: false}),
                    'matching': Array(sections['matching'].length).fill(null),
                    'all': Array(
                        sections['multiple-choice'].length + 
                        sections['multiple-response'].length + 
                        sections['matching'].length
                    ).fill(null)
                };
                
                setSection('multiple-choice');
            }
        }

        function previousCard() {
            if (currentQuestion > 0) {
                currentQuestion--;
                const storedAnswer = answers[currentSection][currentQuestion];
                
                if (isMultipleResponseQuestion()) {
                    selectedOptions = storedAnswer?.selected || [];
                    isSubmitted = storedAnswer?.submitted || false;
                } else {
                    selectedOption = storedAnswer;
                }
                
                loadQuestion();
            }
        }

        function getTotalQuestions() {
            if (currentSection === 'all') {
                return sections['multiple-choice'].length + 
                       sections['multiple-response'].length + 
                       sections['matching'].length;
            } else if (currentSection === 'matching') {
                return sections['matching'].length;
            } else {
                return sections[currentSection].length;
            }
        }

        function getQuestionData(section, index) {
            if (section === 'all') {
                if (index < sections['multiple-choice'].length) {
                    return sections['multiple-choice'][index];
                } else if (index < sections['multiple-choice'].length + sections['multiple-response'].length) {
                    return sections['multiple-response'][index - sections['multiple-choice'].length];
                } else {
                    return sections['matching'][index - sections['multiple-choice'].length - sections['multiple-response'].length];
                }
            } else if (section === 'matching') {
                return sections['matching'][index];
            } else {
                return sections[section][index];
            }
        }

        // Initialize
        setSection('multiple-choice');
        
        // Keyboard shortcuts
        document.addEventListener('keydown', function(event) {
            if (event.key >= '1' && event.key <= '5') {
                const index = parseInt(event.key) - 1;
                const questionData = getCurrentQuestionData();
                if (!isMatchingSection()) {
                    selectOption(index, questionData);
                }
            } else if (event.key >= 'a' && event.key <= 'e') {
                const index = event.key.charCodeAt(0) - 97;
                const questionData = getCurrentQuestionData();
                if (!isMatchingSection()) {
                    selectOption(index, questionData);
                }
            } else if (event.key === 'Enter' && isMultipleResponseQuestion()) {
                if (selectedOptions.length > 0 && !isSubmitted) {
                    submitAnswer();
                }
            } else if (event.key === 'ArrowLeft') {
                if (!document.getElementById('prevBtn').disabled) {
                    previousCard();
                }
            } else if (event.key === 'ArrowRight') {
                if (!document.getElementById('nextBtn').disabled) {
                    nextCard();
                }
            } else if (event.key === ' ' || event.key === 'Spacebar') {
                if (!document.getElementById('nextBtn').disabled && !isMultipleResponseQuestion()) {
                    nextCard();
                }
            } else if (event.key === 'Escape') {
                cancelSelection();
            }
        });
    </script>
</body>
</html>
